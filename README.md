# rust-study
```bash
cargo run --bin xxx
```

## 静态变量，动态变量和常量
- 静态变量`let` 动态变量`let mut` 常量`const`
- 静态变量默认的，不可变的变量
- 动态变量需要加`mut`关键字表明，类型不变，但数据可变
- 常量变量，一直不能变的量

## mut和shadow区别
- 不用`let`关键字重新分配变量会得到一个编译时错误，使用`let`关键字重新分配后，这个变量是不可变的
- 再次使用`let`关键字时，会重新创建一个变量，所以可以改变值的类型，但可以使用相同的变量名称，`mut`的变量类型不可变

## 数据类型

`rust`是静态类型语言，必须在编译时就知道所有变量类型，主要有两个数据类型：`scalar`和`compound`

### Scalar

主要分为四种：整型、浮点型、布尔型和字符型。其中整型分为无符号和有符号，还有长度的区分;浮点型分为单精度(`f32`)和双精度(`f64`);布尔值只有`true`和`false`;单引号指定字符，双引号指定字符串

整型和浮点型要注意溢出，具体操作
- 用`wrapping_*`的方法，比如`wrapping_add`
- 如果用`checked_*`方法有溢出，则返回`None`
- 用`overflowing_*`的返回值表明有没有溢出
- `saturating_*`对最大或最小值进行饱和的方法

### Compound

多个值组合成一个类型

#### 元组类型
- 有固定长度，一旦声明，大小不可变
- 每个位置都有一个类型，不同值的类型可以不同
- 可以使用模式匹配来获取值，如`let (x, y, z) = tup;`
- 可以使用`.{index}`访问元素，如`tup.0`

#### 数组类型
- 相同的类型
- 固定长度
- 内存分配在栈上
- 使用下标访问


## 函数
- `fn`关键字
- 用小写字母+下划线样式命名
- `->`表明返回类型，可以使用`return`提前返回

## 语句和表达式
- 语句是执行某些操作而不返回值的指令
- 表达式是计算的结果值
- 函数调用是一个表达式
- 宏调用是一个表达式
- 花括号的作用域是一个表达式
- 表达式没有结尾的分号，如果在表达式结尾添加分号，则转换为语句，然后就没有返回值

```rust
{
    let x = 3; // 语句
    x + 1; // 语句，没有返回值
    x + 1 // 表达式，返回4
}
```

## 控制语句
- 条件判断`if-else`
- 循环`loop`,可以有返回值
- 循环标记必须以`'`开头，可以用`break`或`continue`指定到循环标记
- 循环`while condition`
- 遍历集合`for element in collection`


# 归属权
- 归属权是为了解决程序在运行过程中，内存释放的问题，目前有两种方案：垃圾回收机制和程序员主动释放
- rust采用归属权的方案解决内存释放的问题
- 归属权的主要目的是管理堆栈数据

## 堆和栈
- 保存在栈上的数据，必须是已知固定大小的，后进先出的
- 保存在堆上的数据，在编译时可以不知道大小
- 堆上分配的空间，返回一个指针
- 在栈上分配内存比在堆上分配内存快得多，获取数据也会比堆上快
- 调用一个函数时，函数的形参会放到堆上，函数的局部变量会放到栈上，当函数调用结束，栈上的数据会被清空

## 归属权规则
- rust中每个值都有归属者
- 每个时刻，都只能有一个归属者
- 当归属者离开作用域，数据也会被回收

## 字符串
- 字面字符串是不可变的，在栈上分配内存
- String类型是可变的， 在堆上分配内存

